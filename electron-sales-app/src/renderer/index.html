<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales Manager</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script>
        // Check authentication on page load
        window.addEventListener('DOMContentLoaded', () => {
            const currentUser = sessionStorage.getItem('currentUser');
            if (!currentUser) {
                // Redirect to login if not authenticated
                window.location.href = 'login.html';
            } else {
                // Show user info in header
                const user = JSON.parse(currentUser);
                const userInfoDiv = document.createElement('div');
                userInfoDiv.className = 'user-info';
                userInfoDiv.innerHTML = `
                    <span class="user-name">${user.fullName}</span>
                    <span class="user-role">${user.role}</span>
                    <button id="logoutBtn" class="btn-icon" title="Logout">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                            <polyline points="16 17 21 12 16 7"/>
                            <line x1="21" y1="12" x2="9" y2="12"/>
                        </svg>
                    </button>
                `;
                document.querySelector('.header-right').prepend(userInfoDiv);
                
                // Show Users tab only for admins
                if (user.role === 'Admin') {
                    const usersNavTab = document.getElementById('usersNavTab');
                    if (usersNavTab) {
                        usersNavTab.style.display = 'flex';
                    }
                }
                
                // Add logout functionality
                document.getElementById('logoutBtn').addEventListener('click', () => {
                    sessionStorage.removeItem('currentUser');
                    window.location.href = 'login.html';
                });
            }
        });
    </script>
</head>
<body>
    <!-- Main Application -->
    <div id="app" class="app-container" style="display: none;">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <h1 class="app-title">
                    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 3v18h18"/>
                        <path d="M18 17V9"/>
                        <path d="M13 17V5"/>
                        <path d="M8 17v-3"/>
                    </svg>
                    <span data-translate="app.title">Sales Manager</span>
                </h1>
                <span id="workbookPath" class="workbook-path" data-translate="common.noWorkbook">No workbook loaded</span>
            </div>
            <div class="header-right">
                <button id="themeToggle" class="btn-icon" title="Toggle Theme">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                    </svg>
                </button>
                <button id="refreshBtn" class="btn-icon" title="Refresh Data">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
                    </svg>
                </button>
                <button id="fileMenuBtn" class="btn-icon" title="Save a Copy">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7,10 12,15 17,10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                </button>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <nav class="nav-tabs">
            <button class="nav-tab active" data-tab="dashboard">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 3v18h18"/>
                    <path d="M18 17V9"/>
                    <path d="M13 17V5"/>
                    <path d="M8 17v-3"/>
                </svg>
                <span data-translate="navigation.dashboard">Dashboard</span>
            </button>
            <button class="nav-tab" data-tab="products">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                    <path d="M3.27 6.96L12 12.01l8.73-5.05M12 22.08V12"/>
                </svg>
                <span data-translate="navigation.products">Products</span>
            </button>
            <button class="nav-tab" data-tab="customers">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                    <circle cx="9" cy="7" r="4"/>
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"/>
                </svg>
                <span data-translate="navigation.customers">Customers</span>
            </button>
            <button class="nav-tab" data-tab="sales">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="9" cy="21" r="1"/>
                    <circle cx="20" cy="21" r="1"/>
                    <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
                </svg>
                <span data-translate="navigation.sales">Sales & Invoices</span>
            </button>
            <button class="nav-tab" data-tab="inventory">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                    <path d="M12 22V12"/>
                    <path d="M3.27 6.96L12 12.01l8.73-5.05"/>
                </svg>
                <span data-translate="navigation.inventory">Inventory</span>
            </button>
            <button class="nav-tab" data-tab="analytics">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 3v18h18"/>
                    <path d="M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"/>
                </svg>
                <span data-translate="navigation.analytics">Analytics</span>
            </button>
            <button class="nav-tab" data-tab="reports">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 20V10"/>
                    <path d="M12 20V4"/>
                    <path d="M6 20v-6"/>
                </svg>
                <span data-translate="navigation.reports">Reports</span>
            </button>
            <button class="nav-tab" data-tab="users" id="usersNavTab" style="display: none;">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                    <circle cx="9" cy="7" r="4"/>
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                    <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                </svg>
                <span data-translate="navigation.users">Users</span>
            </button>
            <button class="nav-tab" data-tab="settings">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="3"/>
                    <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
                </svg>
                <span data-translate="navigation.settings">Settings</span>
            </button>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Tab -->
            <div id="dashboardTab" class="tab-content active">
                <div class="dashboard-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 6v6l4 2"/>
                            </svg>
                        </div>
                        <div class="stat-info">
                            <h3>Total Sales</h3>
                            <p class="stat-value" id="totalSales">$0.00</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M3 3v18h18"/>
                                <path d="M18 17V9"/>
                                <path d="M13 17V5"/>
                                <path d="M8 17v-3"/>
                            </svg>
                        </div>
                        <div class="stat-info">
                            <h3>Total Profit</h3>
                            <p class="stat-value" id="totalProfit">$0.00</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                                <path d="M3.27 6.96L12 12.01l8.73-5.05M12 22.08V12"/>
                            </svg>
                        </div>
                        <div class="stat-info">
                            <h3>Products</h3>
                            <p class="stat-value" id="totalProducts">0</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                                <circle cx="9" cy="7" r="4"/>
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"/>
                            </svg>
                        </div>
                        <div class="stat-info">
                            <h3>Customers</h3>
                            <p class="stat-value" id="totalCustomers">0</p>
                        </div>
                    </div>
                </div>

                <div class="dashboard-section">
                    <h2>Recent Invoices</h2>
                    <div id="recentInvoices" class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Invoice ID</th>
                                    <th>Date</th>
                                    <th>Customer</th>
                                    <th>Amount</th>
                                    <th>Profit</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="recentInvoicesBody">
                                <tr>
                                    <td colspan="6" class="empty-state">No invoices yet</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="dashboard-section">
                    <h2>Low Stock Alert</h2>
                    <div id="lowStockAlert" class="alert-container">
                        <p class="empty-state">All products are well stocked</p>
                    </div>
                </div>
            </div>

            <!-- Products Tab -->
            <div id="productsTab" class="tab-content">
                <div class="tab-header">
                    <h2>Products Management</h2>
                    <button id="addProductBtn" class="btn btn-primary">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 5v14M5 12h14"/>
                        </svg>
                        Add Product
                    </button>
                </div>

                <div class="search-bar">
                    <input type="text" id="productSearch" placeholder="Search products..." class="search-input">
                </div>

                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Product Name</th>
                                <th>Quantity</th>
                                <th>Buy Price</th>
                                <th>Sale Price</th>
                                <th>Profit Margin</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="productsTableBody">
                            <tr>
                                <td colspan="6" class="empty-state">No products found</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Customers Tab -->
            <div id="customersTab" class="tab-content">
                <div class="tab-header">
                    <h2>Customers Management</h2>
                    <button id="addCustomerBtn" class="btn btn-primary">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 5v14M5 12h14"/>
                        </svg>
                        Add Customer
                    </button>
                </div>

                <div class="search-bar">
                    <input type="text" id="customerSearch" placeholder="Search customers..." class="search-input">
                </div>

                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Customer Name</th>
                                <th>Phone</th>
                                <th>Email</th>
                                <th>Address</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="customersTableBody">
                            <tr>
                                <td colspan="5" class="empty-state">No customers found</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Sales & Invoices Tab -->
            <div id="salesTab" class="tab-content">
                <div class="tab-header">
                    <h2>Sales & Invoices</h2>
                    <button id="newInvoiceBtn" class="btn btn-primary">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 5v14M5 12h14"/>
                        </svg>
                        New Invoice
                    </button>
                </div>

                <!-- Invoice Filters -->
                <div class="invoice-filters">
                    <div class="filter-group">
                        <label for="invoiceStatusFilter">Status:</label>
                        <select id="invoiceStatusFilter" class="form-control">
                            <option value="all">All Statuses</option>
                            <option value="Paid">Paid</option>
                            <option value="Pending">Pending</option>
                            <option value="Cancelled">Cancelled</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="invoiceCustomerFilter">Customer:</label>
                        <select id="invoiceCustomerFilter" class="form-control">
                            <option value="all">All Customers</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="invoiceDateFilter">Date:</label>
                        <input type="date" id="invoiceDateFilter" class="form-control" placeholder="Select date">
                    </div>
                    <button id="clearInvoiceFilters" class="btn btn-secondary btn-small">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                        </svg>
                        Clear Filters
                    </button>
                </div>

                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Invoice ID</th>
                                <th>Date</th>
                                <th>Customer</th>
                                <th>Total Amount</th>
                                <th>Total Profit</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="invoicesTableBody">
                            <tr>
                                <td colspan="7" class="empty-state">No invoices found</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Inventory Tab -->
            <div id="inventoryTab" class="tab-content">
                <div class="tab-header">
                    <h2>Inventory Management</h2>
                    <button id="addStockBtn" class="btn btn-primary">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 5v14M5 12h14"/>
                        </svg>
                        Stock Movement
                    </button>
                </div>

                <!-- Inventory Summary Cards -->
                <div class="dashboard-grid" style="margin-bottom: 2rem;">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                                <circle cx="8.5" cy="7" r="4"/>
                                <path d="M20 8v6M23 11h-6"/>
                            </svg>
                        </div>
                        <div class="stat-info">
                            <h3>Total Items In Stock</h3>
                            <p class="stat-value" id="totalStockItems">0</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                            </svg>
                        </div>
                        <div class="stat-info">
                            <h3>Total Stock Value</h3>
                            <p class="stat-value" id="totalStockValue">$0.00</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                                <path d="M12 9v4M12 17h.01"/>
                            </svg>
                        </div>
                        <div class="stat-info">
                            <h3>Low Stock Items</h3>
                            <p class="stat-value" id="lowStockCount">0</p>
                        </div>
                    </div>
                </div>

                <!-- Stock Movements Table -->
                <div class="dashboard-section">
                    <h2>Recent Stock Movements</h2>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Product</th>
                                    <th>Type</th>
                                    <th>Quantity</th>
                                    <th>Reference</th>
                                    <th>Balance After</th>
                                    <th>Notes</th>
                                </tr>
                            </thead>
                            <tbody id="inventoryTableBody">
                                <tr>
                                    <td colspan="7" class="empty-state">No inventory movements yet</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Analytics Tab -->
            <div id="analyticsTab" class="tab-content">
                <div class="tab-header">
                    <h2>Analytics & Statistics</h2>
                    <div class="analytics-period">
                        <select id="analyticsPeriod" class="form-control">
                            <option value="7">Last 7 Days</option>
                            <option value="30" selected>Last 30 Days</option>
                            <option value="90">Last 90 Days</option>
                            <option value="365">Last Year</option>
                            <option value="all">All Time</option>
                        </select>
                    </div>
                </div>

                <!-- Key Metrics Grid -->
                <div class="analytics-metrics">
                    <div class="metric-card metric-card-highlight">
                        <div class="metric-icon">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 6v6l4 2"/>
                            </svg>
                        </div>
                        <div class="metric-info">
                            <h4>Today's Profit</h4>
                            <p class="metric-value" id="todayProfitValue">$0.00</p>
                            <span class="metric-change positive" id="todayProfitChange">Today</span>
                        </div>
                    </div>
                    <div class="metric-card metric-card-highlight">
                        <div class="metric-icon">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 6v6l-4 2"/>
                            </svg>
                        </div>
                        <div class="metric-info">
                            <h4>Yesterday's Profit</h4>
                            <p class="metric-value" id="yesterdayProfitValue">$0.00</p>
                            <span class="metric-change" id="yesterdayProfitChange">Yesterday</span>
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                            </svg>
                        </div>
                        <div class="metric-info">
                            <h4>Average Order Value</h4>
                            <p class="metric-value" id="avgOrderValue">$0.00</p>
                            <span class="metric-change positive" id="avgOrderChange">+0%</span>
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                                <circle cx="8.5" cy="7" r="4"/>
                                <path d="M20 8v6M23 11h-6"/>
                            </svg>
                        </div>
                        <div class="metric-info">
                            <h4>Total Customers</h4>
                            <p class="metric-value" id="totalCustomersMetric">0</p>
                            <span class="metric-change positive" id="customersChange">+0</span>
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                            </svg>
                        </div>
                        <div class="metric-info">
                            <h4>Products Sold</h4>
                            <p class="metric-value" id="totalProductsSold">0</p>
                            <span class="metric-change" id="productsSoldChange">0 units</span>
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M3 3v18h18"/>
                                <path d="M18 17V9l-5 5-5-5-3 3"/>
                            </svg>
                        </div>
                        <div class="metric-info">
                            <h4>Profit Margin</h4>
                            <p class="metric-value" id="profitMarginMetric">0%</p>
                            <span class="metric-change positive" id="profitMarginChange">+0%</span>
                        </div>
                    </div>
                </div>

                <!-- Charts Grid -->
                <div class="charts-grid">
                    <!-- Sales Trend Chart -->
                    <div class="chart-container">
                        <div class="chart-header">
                            <h3>Sales Trend</h3>
                            <p class="chart-subtitle">Revenue over time</p>
                        </div>
                        <canvas id="salesTrendChart"></canvas>
                    </div>

                    <!-- Profit Trend Chart -->
                    <div class="chart-container">
                        <div class="chart-header">
                            <h3>Profit Trend</h3>
                            <p class="chart-subtitle">Profit over time</p>
                        </div>
                        <canvas id="profitTrendChart"></canvas>
                    </div>

                    <!-- Top Products Chart -->
                    <div class="chart-container">
                        <div class="chart-header">
                            <h3>Top Products</h3>
                            <p class="chart-subtitle">Best selling products</p>
                        </div>
                        <canvas id="topProductsChart"></canvas>
                    </div>

                    <!-- Product Categories Chart -->
                    <div class="chart-container">
                        <div class="chart-header">
                            <h3>Sales by Product</h3>
                            <p class="chart-subtitle">Revenue distribution</p>
                        </div>
                        <canvas id="productCategoriesChart"></canvas>
                    </div>

                    <!-- Customer Activity Chart -->
                    <div class="chart-container">
                        <div class="chart-header">
                            <h3>Top Customers</h3>
                            <p class="chart-subtitle">By total purchases</p>
                        </div>
                        <canvas id="topCustomersChart"></canvas>
                    </div>

                    <!-- Inventory Status Chart -->
                    <div class="chart-container">
                        <div class="chart-header">
                            <h3>Inventory Status</h3>
                            <p class="chart-subtitle">Stock levels</p>
                        </div>
                        <canvas id="inventoryStatusChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Reports Tab -->
            <div id="reportsTab" class="tab-content">
                <div class="tab-header">
                    <h2>Reports & Analytics</h2>
                    <button id="exportReportBtn" class="btn btn-secondary">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"/>
                        </svg>
                        Export
                    </button>
                </div>

                <div class="report-filters">
                    <div class="form-group">
                        <label>From Date:</label>
                        <input type="date" id="reportFromDate" class="form-control">
                    </div>
                    <div class="form-group">
                        <label>To Date:</label>
                        <input type="date" id="reportToDate" class="form-control">
                    </div>
                    <button id="filterReportBtn" class="btn btn-primary">Apply Filter</button>
                </div>

                <div class="report-summary">
                    <div class="summary-card">
                        <h3>Total Sales</h3>
                        <p class="summary-value" id="reportTotalSales">$0.00</p>
                    </div>
                    <div class="summary-card">
                        <h3>Total Profit</h3>
                        <p class="summary-value" id="reportTotalProfit">$0.00</p>
                    </div>
                    <div class="summary-card">
                        <h3>Invoices Count</h3>
                        <p class="summary-value" id="reportInvoiceCount">0</p>
                    </div>
                </div>

                <div class="report-section">
                    <h3>Sales by Product</h3>
                    <div id="salesByProduct" class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Product</th>
                                    <th>Quantity Sold</th>
                                    <th>Total Sales</th>
                                    <th>Total Profit</th>
                                </tr>
                            </thead>
                            <tbody id="salesByProductBody">
                                <tr>
                                    <td colspan="4" class="empty-state">No data available</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Users Tab (Admin Only) -->
            <div id="usersTab" class="tab-content">
                <div class="tab-header">
                    <h2>User Management</h2>
                    <button id="addUserBtn" class="btn btn-primary">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                            <circle cx="8.5" cy="7" r="4"/>
                            <line x1="20" y1="8" x2="20" y2="14"/>
                            <line x1="23" y1="11" x2="17" y2="11"/>
                        </svg>
                        Add User
                    </button>
                </div>

                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Username</th>
                                <th>Full Name</th>
                                <th>Role</th>
                                <th>Email</th>
                                <th>Created Date</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                            <tr>
                                <td colspan="7" class="empty-state">Loading users...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Settings Tab -->
            <div id="settingsTab" class="tab-content">
                <div class="tab-header">
                    <h2>Settings</h2>
                </div>

                <div class="settings-container">
                    <!-- Language Settings -->
                    <div class="settings-section">
                        <h3>Language & Region</h3>
                        <div class="settings-group">
                            <label for="languageSelect">Language</label>
                            <select id="languageSelect" class="form-control">
                                <option value="en">English</option>
                                <option value="fr">Français</option>
                                <option value="ar">العربية</option>
                            </select>
                            <p class="form-hint">Choose your preferred language for the application interface.</p>
                        </div>
                    </div>

                    <!-- Display Settings -->
                    <div class="settings-section">
                        <h3>Display</h3>
                        <div class="settings-group">
                            <label for="themeSelect">Theme</label>
                            <select id="themeSelect" class="form-control">
                                <option value="light">Light</option>
                                <option value="dark">Dark</option>
                                <option value="auto">Auto (System)</option>
                            </select>
                            <p class="form-hint">Choose your preferred theme for the application.</p>
                        </div>
                        <div class="settings-group">
                            <label for="fontSizeSelect">Font Size</label>
                            <select id="fontSizeSelect" class="form-control">
                                <option value="small">Small</option>
                                <option value="medium">Medium</option>
                                <option value="large">Large</option>
                            </select>
                            <p class="form-hint">Adjust the text size for better readability.</p>
                        </div>
                    </div>

                    <!-- Data Settings -->
                    <div class="settings-section">
                        <h3>Data Management</h3>
                        <div class="settings-group">
                            <label for="autoBackupToggle">Auto Backup</label>
                            <div class="toggle-switch">
                                <input type="checkbox" id="autoBackupToggle" checked>
                                <span class="toggle-slider"></span>
                            </div>
                            <p class="form-hint">Automatically create backup copies when saving data.</p>
                        </div>
                        <div class="settings-group">
                            <label for="backupRetentionSelect">Backup Retention</label>
                            <select id="backupRetentionSelect" class="form-control">
                                <option value="3">3 backups</option>
                                <option value="5" selected>5 backups</option>
                                <option value="10">10 backups</option>
                                <option value="unlimited">Unlimited</option>
                            </select>
                            <p class="form-hint">Number of backup files to keep.</p>
                        </div>
                    </div>

                    <!-- Notification Settings -->
                    <div class="settings-section">
                        <h3>Notifications</h3>
                        <div class="settings-group">
                            <label for="lowStockNotificationsToggle">Low Stock Alerts</label>
                            <div class="toggle-switch">
                                <input type="checkbox" id="lowStockNotificationsToggle" checked>
                                <span class="toggle-slider"></span>
                            </div>
                            <p class="form-hint">Receive notifications when products are running low on stock.</p>
                        </div>
                        <div class="settings-group">
                            <label for="soundNotificationsToggle">Sound Notifications</label>
                            <div class="toggle-switch">
                                <input type="checkbox" id="soundNotificationsToggle" checked>
                                <span class="toggle-slider"></span>
                            </div>
                            <p class="form-hint">Play sound effects for notifications.</p>
                        </div>
                    </div>

                    <!-- Application Settings -->
                    <div class="settings-section">
                        <h3>Application</h3>
                        <div class="settings-group">
                            <label for="startupBehaviorSelect">Startup Behavior</label>
                            <select id="startupBehaviorSelect" class="form-control">
                                <option value="lastWorkbook">Open last used workbook</option>
                                <option value="defaultWorkbook">Open default workbook</option>
                                <option value="prompt">Ask which workbook to open</option>
                            </select>
                            <p class="form-hint">Choose what happens when the application starts.</p>
                        </div>
                        <div class="settings-group">
                            <label for="autoRefreshToggle">Auto Refresh Data</label>
                            <div class="toggle-switch">
                                <input type="checkbox" id="autoRefreshToggle">
                                <span class="toggle-slider"></span>
                            </div>
                            <p class="form-hint">Automatically refresh data every 5 minutes.</p>
                        </div>
                    </div>

                    <!-- Actions -->
                    <div class="settings-actions">
                        <button id="saveSettingsBtn" class="btn btn-primary">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
                                <polyline points="17,21 17,13 7,13 7,21"/>
                                <polyline points="7,3 7,8 15,8"/>
                            </svg>
                            Save Settings
                        </button>
                        <button id="resetSettingsBtn" class="btn btn-secondary">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
                                <path d="M21 3v5h-5"/>
                                <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
                                <path d="M3 21v-5h5"/>
                            </svg>
                            Reset to Defaults
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Product Modal -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="productModalTitle">Add Product</h2>
                <button class="modal-close">&times;</button>
            </div>
            <form id="productForm" class="modal-form">
                <div class="form-group">
                    <label for="productName">Product Name *</label>
                    <input type="text" id="productName" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="productQuantity">Quantity *</label>
                    <input type="number" id="productQuantity" class="form-control" min="0" required>
                </div>
                <div class="form-group">
                    <label for="productBuyPrice">Buy Price *</label>
                    <input type="number" id="productBuyPrice" class="form-control" min="0" step="0.01" required>
                </div>
                <div class="form-group">
                    <label for="productSalePrice">Sale Price *</label>
                    <input type="number" id="productSalePrice" class="form-control" min="0" step="0.01" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary modal-cancel">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Customer Modal -->
    <div id="customerModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="customerModalTitle">Add Customer</h2>
                <button class="modal-close">&times;</button>
            </div>
            <form id="customerForm" class="modal-form">
                <div class="form-group">
                    <label for="customerName">Customer Name *</label>
                    <input type="text" id="customerName" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="customerPhone">Phone</label>
                    <input type="tel" id="customerPhone" class="form-control">
                </div>
                <div class="form-group">
                    <label for="customerEmail">Email</label>
                    <input type="email" id="customerEmail" class="form-control">
                </div>
                <div class="form-group">
                    <label for="customerAddress">Address</label>
                    <textarea id="customerAddress" class="form-control" rows="3"></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary modal-cancel">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Invoice Modal -->
    <div id="invoiceModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>New Invoice</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-form">
                <div class="invoice-header-form">
                    <div class="form-group">
                        <label for="invoiceCustomer">Customer *</label>
                        <div class="autocomplete-wrapper">
                            <input type="text" id="invoiceCustomer" class="form-control" placeholder="Type to search..." required>
                            <div id="customerAutocomplete" class="autocomplete-dropdown"></div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="invoiceDate">Date *</label>
                        <input type="date" id="invoiceDate" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="invoiceStatus">Status</label>
                        <select id="invoiceStatus" class="form-control">
                            <option value="Pending">Pending</option>
                            <option value="Paid">Paid</option>
                            <option value="Cancelled">Cancelled</option>
                        </select>
                    </div>
                </div>

                <h3>Invoice Items</h3>
                <div class="invoice-items-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="itemProduct">Product</label>
                            <div class="autocomplete-wrapper">
                                <input type="text" id="itemProduct" class="form-control" placeholder="Type to search...">
                                <div id="productAutocomplete" class="autocomplete-dropdown"></div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="itemQuantity">Quantity</label>
                            <input type="number" id="itemQuantity" class="form-control" min="1" value="1">
                        </div>
                        <div class="form-group">
                            <label for="itemUnitPrice">Unit Price</label>
                            <input type="number" id="itemUnitPrice" class="form-control" min="0" step="0.01" readonly>
                        </div>
                        <div class="form-group">
                            <label for="itemTotal">Total</label>
                            <input type="number" id="itemTotal" class="form-control" readonly>
                        </div>
                        <div class="form-group">
                            <label>&nbsp;</label>
                            <button type="button" id="addItemBtn" class="btn btn-primary">Add Item</button>
                        </div>
                    </div>
                </div>

                <div class="invoice-items-list">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Quantity</th>
                                <th>Unit Price</th>
                                <th>Total</th>
                                <th>Profit</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="invoiceItemsBody">
                            <tr>
                                <td colspan="6" class="empty-state">No items added yet</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="invoice-summary">
                    <div class="summary-row">
                        <span>Total Amount:</span>
                        <strong id="invoiceTotalAmount">$0.00</strong>
                    </div>
                    <div class="summary-row">
                        <span>Total Profit:</span>
                        <strong id="invoiceTotalProfit">$0.00</strong>
                    </div>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary modal-cancel">Cancel</button>
                    <button type="button" id="saveInvoiceBtn" class="btn btn-primary">Save Invoice</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Invoice Status Modal -->
    <div id="editStatusModal" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2>Edit Invoice Status</h2>
                <button class="modal-close">&times;</button>
            </div>
            <form id="editStatusForm" class="modal-form">
                <div class="form-group">
                    <label>Invoice ID</label>
                    <input type="text" id="editStatusInvoiceId" class="form-control" readonly>
                </div>
                <div class="form-group">
                    <label>Customer</label>
                    <input type="text" id="editStatusCustomer" class="form-control" readonly>
                </div>
                <div class="form-group">
                    <label for="editStatusSelect">Status *</label>
                    <select id="editStatusSelect" class="form-control" required>
                        <option value="Paid">Paid</option>
                        <option value="Pending">Pending</option>
                        <option value="Cancelled">Cancelled</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary modal-cancel">Cancel</button>
                    <button type="submit" class="btn btn-primary">Update Status</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Inventory Movement Modal -->
    <div id="inventoryModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Stock Movement</h2>
                <button class="modal-close">&times;</button>
            </div>
            <form id="inventoryForm" class="modal-form">
                <div class="form-group">
                    <label for="movementProduct">Product *</label>
                    <select id="movementProduct" class="form-control" required>
                        <option value="">Select Product</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="movementType">Movement Type *</label>
                    <select id="movementType" class="form-control" required>
                        <option value="IN">Stock In (Purchase/Return)</option>
                        <option value="OUT">Stock Out (Sale/Damage)</option>
                        <option value="ADJUSTMENT">Adjustment (Inventory Count)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="movementQuantity">Quantity *</label>
                    <input type="number" id="movementQuantity" class="form-control" min="1" required>
                    <small class="form-hint">Current stock: <span id="currentStock">0</span></small>
                </div>
                <div class="form-group">
                    <label for="movementDate">Date *</label>
                    <input type="date" id="movementDate" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="movementReference">Reference</label>
                    <input type="text" id="movementReference" class="form-control" placeholder="PO#, Invoice#, etc.">
                </div>
                <div class="form-group">
                    <label for="movementNotes">Notes</label>
                    <textarea id="movementNotes" class="form-control" rows="3" placeholder="Additional notes..."></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary modal-cancel">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Movement</button>
                </div>
            </form>
        </div>
    </div>

    <!-- User Modal -->
    <div id="userModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="userModalTitle">Add User</h2>
                <button class="modal-close">&times;</button>
            </div>
            <form id="userForm" class="modal-form">
                <div class="form-group">
                    <label for="userUsername">Username *</label>
                    <input type="text" id="userUsername" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="userPassword">Password *</label>
                    <input type="password" id="userPassword" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="userFullName">Full Name *</label>
                    <input type="text" id="userFullName" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="userRole">Role *</label>
                    <select id="userRole" class="form-control" required>
                        <option value="Admin">Admin</option>
                        <option value="Manager">Manager</option>
                        <option value="Cashier">Cashier</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="userEmail">Email</label>
                    <input type="email" id="userEmail" class="form-control">
                </div>
                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="userIsActive" checked>
                        <span>Active User</span>
                    </label>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary modal-cancel">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save User</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <script src="../../dist/renderer/renderer.js"></script>
</body>
</html>
